# نظام المنصة الأساسية (Core Platform System)

---

## Executive Summary

يُعد نظام المنصة الأساسية العمود الفقري لمنصة حجز الباصات متعددة البائعين، حيث يوفر البنية التحتية البرمجية والتقنية التي تُمكّن جميع الأنظمة الفرعية من العمل بشكل متكامل ومتناسق. يهدف هذا النظام إلى إنشاء بيئة رقمية موحدة تربط بين مكاتب النقل (البائعين) والركاب (المشترين) في سوق ديناميكي يشمل النقل الداخلي بين محافظات الجمهورية اليمنية والنقل الدولي بين اليمن والمملكة العربية السعودية.

تتجسد أهمية هذا النظام في قدرته على توحيد تجربة المستخدم عبر مختلف القنوات، وضمان استقرار المنصة تحت أحمال تشغيلية متفاوتة، وتوفير البنية اللازمة لنموذج العمل القائم على العمولات. كما يضمن النظام التكامل السلس بين جميع المكونات من خلال واجهات برمجة تطبيقات موحدة (APIs) وبنية تحتية للبيانات تدعم العمليات المعقدة للحجز والدفع والتقارير.

---

## Business Objectives

### الأهداف الاستراتيجية

| الهدف | الوصف | المؤشر الرئيسي |
|-------|-------|---------------|
| بناء سوق رقمي موحد | إنشاء منصة مركزية تجمع جميع مكاتب النقل في سوق واحد | عدد المكاتب المسجلة |
| تحسين كفاءة الحجز | تقليل الوقت المستغرق في عملية البحث والحجز | متوسط وقت إتمام الحجز |
| زيادة الشفافية | توفير معلومات واضحة عن الرحلات والأسعار والتقييمات | نسبة رضا العملاء |
| تعظيم الإيرادات | تحقيق إيرادات مستدامة عبر نموذج العمولات | إجمالي العمولات الشهرية |
| التوسع الجغرافي | دعم النقل الداخلي والدولي عبر منصة واحدة | عدد المسارات النشطة |

### الأهداف التشغيلية

1. **تقليل الاحتكاك التشغيلي**: تبسيط العمليات المعقدة في إدارة الرحلات والحجوزات والمدفوعات
2. **تمكين المكاتب**: توفير أدوات رقمية متكاملة لإدارة العمليات اليومية
3. **تعزيز الثقة**: بناء نظام تقييم ومراجعات يضمن جودة الخدمة
4. **ضمان الاستقرار**: بناء بنية تحتية قادرة على التعامل مع الذروات الموسمية

---

## Scope

### نطاق النظام الداخلي (In-Scope)

```
┌─────────────────────────────────────────────────────────────────┐
│                    نطاق نظام المنصة الأساسية                      │
├─────────────────────────────────────────────────────────────────┤
│  ✓ البنية التحتية للمنصة الرقمية                                 │
│  ✓ إدارة التكامل بين الأنظمة الفرعية                              │
│  ✓ توحيد تجربة المستخدم عبر القنوات المختلفة                       │
│  ✓ إدارة دورة حياة الطلبات (Request Lifecycle)                   │
│  ✓ التعامل مع الأخطاء والاستثناءات (Error Handling)               │
│  ✓ إدارة الجلسات والحالات (Session & State Management)           │
│  ✓ التخزين المؤقت والأداء (Caching & Performance)                │
│  ✓ إدارة التكوين والإعدادات (Configuration Management)           │
│  ✓ التسجيل والمراقبة (Logging & Monitoring)                      │
│  ✓ التكامل مع خدمات الطرف الثالث                                 │
└─────────────────────────────────────────────────────────────────┘
```

### خارج نطاق النظام (Out-of-Scope)

- تطوير أنظمة تشغيل الباصات الفعلية (GPS Tracking Hardware)
- إدارة الموارد البشرية للمكاتب
- الأنظمة المحاسبية الخارجية للمكاتب
- خدمات الدفع خارج المنصة

---

## Detailed Functional Requirements

### FR-CP-001: إدارة دورة حياة الطلبات

| المعرف | المتطلب | الأولوية |
|--------|---------|----------|
| FR-CP-001-01 | يجب أن يقوم النظام بإنشاء معرف فريد لكل طلب (Request ID) | حرجة |
| FR-CP-001-02 | يجب تتبع حالة الطلب عبر جميع مراحل المعالجة | حرجة |
| FR-CP-001-03 | يجب توفير آلية لإلغاء الطلبات في المراحل المسموح بها | عالية |
| FR-CP-001-04 | يجب الاحتفاظ بسجل كامل لجميع العمليات على الطلب | حرجة |

### FR-CP-002: إدارة الجلسات

| المعرف | المتطلب | الأولوية |
|--------|---------|----------|
| FR-CP-002-01 | يجب إنشاء جلسة آمنة عند تسجيل الدخول | حرجة |
| FR-CP-002-02 | يجب انتهاء الجلسة تلقائياً بعد فترة من عدم النشاط | حرجة |
| FR-CP-002-03 | يجب السماح بجلسة واحدة فقط لكل مستخدم على الجهاز الواحد | متوسطة |
| FR-CP-002-04 | يجب توفير إمكانية إنهاء جميع الجلسات عن بُعد | عالية |

### FR-CP-003: إدارة التكوين

| المعرف | المتطلب | الأولوية |
|--------|---------|----------|
| FR-CP-003-01 | يجب دعم إعدادات مختلفة لبيئات التطوير والاختبار والإنتاج | حرجة |
| FR-CP-003-02 | يجب السماح بتغيير الإعدادات دون إعادة تشغيل النظام | عالية |
| FR-CP-003-03 | يجب تسجيل جميع تغييرات الإعدادات في سجل التدقيق | حرجة |

### FR-CP-004: إدارة التخزين المؤقت

| المعرف | المتطلب | الأولوية |
|--------|---------|----------|
| FR-CP-004-01 | يجب تخزين بيانات الرحلات الشائعة مؤقتاً | عالية |
| FR-CP-004-02 | يجب إبطال ذاكرة التخزين المؤقت عند تغيير البيانات | حرجة |
| FR-CP-004-03 | يجب دعم مستويات متعددة للتخزين المؤقت | متوسطة |

---

## Non-Functional Requirements

### NFR-CP-001: الأداء

| المعرف | المتطلب | القيمة المستهدفة |
|--------|---------|-----------------|
| NFR-CP-001-01 | وقت استجابة البحث عن الرحلات | < 2 ثانية |
| NFR-CP-001-02 | وقت استجابة تحميل الصفحة الرئيسية | < 3 ثوانٍ |
| NFR-CP-001-03 | إجمالي وقت إتمام الحجز | < 5 دقائق |
| NFR-CP-001-04 | عدد المستخدمين المتزامنين | 10,000+ |

### NFR-CP-002: التوفر

| المعرف | المتطلب | القيمة المستهدفة |
|--------|---------|-----------------|
| NFR-CP-002-01 | نسبة التوفر الشهرية | 99.9% |
| NFR-CP-002-02 | وقت التعافي من الأعطال (RTO) | < 4 ساعات |
| NFR-CP-002-03 | نقطة استعادة البيانات (RPO) | < 15 دقيقة |

### NFR-CP-003: الأمان

| المعرف | المتطلب | الأولوية |
|--------|---------|----------|
| NFR-CP-003-01 | تشفير جميع الاتصالات باستخدام TLS 1.3 | حرجة |
| NFR-CP-003-02 | حماية ضد هجمات DDoS | حرجة |
| NFR-CP-003-03 | حماية ضد هجمات SQL Injection | حرجة |
| NFR-CP-003-04 | حماية ضد هجمات XSS | حرجة |

### NFR-CP-004: القابلية للتوسع

| المعرف | المتطلب | الأولوية |
|--------|---------|----------|
| NFR-CP-004-01 | دعم التوسع الأفقي للخوادم | حرجة |
| NFR-CP-004-02 | دعم التوسع العمودي للموارد | عالية |
| NFR-CP-004-03 | القدرة على إضافة مكاتب جديدة دون توقف | حرجة |

---

## Use Cases

### UC-CP-001: البحث عن رحلات

| العنصر | الوصف |
|--------|-------|
| الممثل | العميل |
| الشرط المسبق | العميل متصل بالمنصة |
| السيناريو الرئيسي | 1. يدخل العميل معايير البحث (من، إلى، التاريخ)<br>2. يقوم النظام بالبحث في قاعدة البيانات<br>3. يعرض النظام قائمة الرحلات المتاحة<br>4. يمكن للعميل تطبيق عوامل التصفية |
| الشرط النهائي | عرض قائمة الرحلات المطابقة للبحث |

### UC-CP-002: عرض تفاصيل الرحلة

| العنصر | الوصف |
|--------|-------|
| الممثل | العميل |
| الشرط المسبق | وجود نتائج بحث |
| السيناريو الرئيسي | 1. ينقر العميل على رحلة محددة<br>2. يقوم النظام بجلب التفاصيل الكاملة<br>3. يعرض النظام معلومات الرحلة والمقاعد المتاحة<br>4. يمكن للعميل بدء عملية الحجز |
| الشرط النهائي | عرض التفاصيل الكاملة للرحلة |

---

## Actors

| الممثل | الوصف | الصلاحيات |
|--------|-------|-----------|
| العميل (Customer) | المستخدم النهائي الذي يبحث ويحجز | البحث، الحجز، الدفع، التقييم |
| ممثل المكتب (Office Representative) | مدير مكتب النقل | إدارة الرحلات، المقاعد، التقارير |
| المشرف (Admin) | فريق إدارة المنصة | إدارة المكاتب، التقارير، الإعدادات |
| النظام (System) | العمليات الآلية | المعالجة الآلية، الإشعارات، التقارير |
| بوابة الدفع (Payment Gateway) | خدمة الدفع الخارجية | معالجة المدفوعات |

---

## Workflows

### سير عمل البحث والحجز

```
┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│   دخول      │────▶│   البحث    │────▶│  عرض النتائج │
│  العميل     │     │  عن رحلات   │     │             │
└─────────────┘     └─────────────┘     └──────┬──────┘
                                                │
                                                ▼
┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│  تأكيد      │◀────│   الدفع    │◀────│  اختيار    │
│   الحجز     │     │             │     │   المقاعد   │
└─────────────┘     └─────────────┘     └─────────────┘
```

### سير عمل معالجة الطلبات الداخلية

**المرحلة الأولى: استقبال الطلب**
- استلام الطلب من واجهة المستخدم
- التحقق من صحة البيانات المدخلة
- إنشاء معرف فريد للطلب
- تسجيل الطلب في سجل العمليات

**المرحلة الثانية: التوجيه**
- تحديد النظام الفرعي المسؤول
- تطبيق قواعد التوجيه (Routing Rules)
- إرسال الطلب إلى النظام المستهدف

**المرحلة الثالثة: المعالجة**
- تنفيذ العملية المطلوبة
- التحقق من صحة النتائج
- تحديث حالة الطلب

**المرحلة الرابعة: الاستجابة**
- تنسيق الاستجابة
- إرسال النتيجة إلى واجهة المستخدم
- تسجيل اكتمال العملية

---

## Data Entities (Conceptual)

### الكيانات الرئيسية

| الكيان | الوصف | العلاقات |
|--------|-------|----------|
| PlatformRequest | الطلبات الواردة للمنصة | مرتبط بـ User، System |
| PlatformSession | جلسات المستخدمين | مرتبط بـ User |
| PlatformConfig | إعدادات المنصة | مستقل |
| PlatformCache | بيانات التخزين المؤقت | مرتبط بـ Multiple |
| PlatformLog | سجلات العمليات | مرتبط بـ Multiple |

### نموذج البيانات المفاهيمي

```
┌─────────────────┐       ┌─────────────────┐
│ PlatformRequest │◀─────▶│  PlatformSession│
└────────┬────────┘       └─────────────────┘
         │
         ▼
┌─────────────────┐       ┌─────────────────┐
│  PlatformLog    │◀─────▶│  PlatformConfig │
└─────────────────┘       └─────────────────┘
```

---

## Business Rules

### القواعد الأساسية

| المعرف | القاعدة | النوع |
|--------|--------|-------|
| BR-CP-001 | جميع الطلبات يجب أن يكون لها معرف فريد | إلزامي |
| BR-CP-002 | لا يمكن معالجة طلب بدون مصادقة صالحة | إلزامي |
| BR-CP-003 | يجب تسجيل جميع الأخطاء في سجل العمليات | إلزامي |
| BR-CP-004 | البيانات المخزنة مؤقتاً يجب أن تكون محدثة | إلزامي |
| BR-CP-005 | يجب إشعار المستخدم في حالة فشل العملية | إلزامي |

### قواعد التوجيه

| المعرف | القاعدة | التطبيق |
|--------|--------|---------|
| BR-CP-006 | طلبات البحث توجه إلى نظام إدارة المسارات | تلقائي |
| BR-CP-007 | طلبات الحجز توجه إلى نظام إدارة الحجوزات | تلقائي |
| BR-CP-008 | طلبات الدفع توجه إلى نظام المدفوعات | تلقائي |

---

## Edge Cases

### الحالات الحدية

| الحالة | الوصف | المعالجة |
|--------|-------|----------|
| EC-CP-001 | فقدان الاتصال أثناء المعالجة | حفظ الحالة واستئناف العملية |
| EC-CP-002 | طلب متزامن على نفس المورد | تطبيق آلية القفل المتفائل |
| EC-CP-003 | بيانات غير صالحة | رفض الطلب مع تفاصيل الخطأ |
| EC-CP-004 | انتهاء مهلة المعالجة | إلغاء العملية وإشعار المستخدم |
| EC-CP-005 | زيادة مفاجئة في الطلبات | تفعيل آلية التوسع التلقائي |

---

## Risk Considerations

### المخاطر التقنية

| المخطر | الاحتمالية | التأثير | الاستراتيجية |
|--------|-----------|---------|--------------|
| انقطاع الخدمة | متوسط | عالي | بنية تحتية متكررة |
| فقدان البيانات | منخفض | حرج | نسخ احتياطي متعدد |
| هجوم إلكتروني | متوسط | عالي | جدران نارية، تشفير |
| بطء الأداء | متوسط | متوسط | تحسين، تخزين مؤقت |

### المخاطر التشغيلية

| المخطر | الاحتمالية | التأثير | الاستراتيجية |
|--------|-----------|---------|--------------|
| عدم قبول المكاتب | متوسط | عالي | برامج تحفيزية |
| مقاومة التحول الرقمي | عالي | متوسط | تدريب، دعم |
| مشاكل الاتصال | عالي | متوسط | دعم الاتصال المنخفض |

---

## Future Enhancements

### التحسينات المستقبلية

| التحسين | الوصف | الأولوية |
|---------|-------|----------|
| FE-CP-001 | دعم الذكاء الاصطناعي للبحث الذكي | عالية |
| FE-CP-002 | تطبيق الجوال الأصلي | عالية |
| FE-CP-003 | دعم اللغات المتعددة | متوسطة |
| FE-CP-004 | تكامل مع خرائط GPS مباشرة | متوسطة |
| FE-CP-005 | نظام توصيات مبني على الذكاء الاصطناعي | منخفضة |
| FE-CP-006 | دعم العملات المتعددة | متوسطة |
| FE-CP-007 | تكامل مع أنظمة السفر الأخرى | منخفضة |

---

## Appendices

### A. المصطلحات التقنية

| المصطلح | التعريف |
|---------|---------|
| API | واجهة برمجة التطبيقات |
| Caching | التخزين المؤقت للبيانات |
| Load Balancing | توزيع الحمل عبر خوادم متعددة |
| Session | جلسة عمل المستخدم |

### B. المراجع

- معايير تصميم أنظمة السوق الإلكترونية
- أفضل ممارسات بناء المنصات متعددة البائعين
- معايير الأمان والحماية للتطبيقات المالية

---

*تم إعداد هذا الملف بواسطة فريق تحليل الأنظمة - منصة حجز الباصات*
*الإصدار: 1.0*
*تاريخ الإعداد: 2026*
